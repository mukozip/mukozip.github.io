<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cow Milk Production</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Recharts -->
  <script src="https://cdn.jsdelivr.net/npm/recharts@2.12.7/umd/Recharts.min.js"></script>
  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; margin:0; padding:0; }
  </style>
</head>
<body class="bg-gray-100 p-4">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;
    const RechartsLoaded = window.Recharts || {};
    const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = RechartsLoaded;

    const initialCows = [
      { name: 'MERCY', lastCalvingDate: '2024-07-14', totalMonthlyProduction: 64.5 },
      { name: 'MAGRET', lastCalvingDate: '2024-07-17', totalMonthlyProduction: 78.5 },
      { name: 'SARAH', lastCalvingDate: '2025-04-18', totalMonthlyProduction: 62.5 }
    ];

    const App = () => {
      const today = new Date().toISOString().split('T')[0];
      const [selectedCow, setSelectedCow] = useState(initialCows[0].name);
      const [selectedDate, setSelectedDate] = useState(today);
      const [amProduction, setAmProduction] = useState('');
      const [pmProduction, setPmProduction] = useState('');
      const [cowData, setCowData] = useState(initialCows.map(c => ({...c, milk_data:{}})));

      const totalDaily = parseFloat(amProduction||0) + parseFloat(pmProduction||0);

      return (
        <div className="min-h-screen bg-gray-50 flex flex-col items-center p-4">
          <div className="w-full max-w-2xl bg-white p-6 rounded-2xl shadow-xl border border-gray-200 mb-8">
            <h1 className="text-3xl font-bold text-center text-gray-800 mb-6">Cow Milk Production</h1>
            <select value={selectedCow} onChange={(e)=>setSelectedCow(e.target.value)} className="w-full p-3 border border-gray-300 rounded-lg mb-4">
              {initialCows.map(c => <option key={c.name} value={c.name}>{c.name}</option>)}
            </select>
            <input type="date" value={selectedDate} onChange={(e)=>setSelectedDate(e.target.value)} className="w-full p-3 border border-gray-300 rounded-lg mb-4" />
            <input type="number" placeholder="AM Production" value={amProduction} onChange={(e)=>setAmProduction(e.target.value)} className="w-full p-3 border border-gray-300 rounded-lg mb-2" />
            <input type="number" placeholder="PM Production" value={pmProduction} onChange={(e)=>setPmProduction(e.target.value)} className="w-full p-3 border border-gray-300 rounded-lg mb-4" />
            <p className="text-gray-700 font-medium">Total Daily Production: {totalDaily}</p>
          </div>

          <div className="w-full max-w-2xl bg-white p-6 rounded-2xl shadow-xl border border-gray-200">
            <h2 className="text-2xl font-bold text-center text-gray-800 mb-4">Production Charts</h2>
            {BarChart ? (
              <ResponsiveContainer width="100%" height={300}>
                <BarChart data={cowData} layout="vertical" margin={{top:20,right:30,left:20,bottom:5}}>
                  <CartesianGrid strokeDasharray="3 3" />
                  <YAxis dataKey="name" type="category" />
                  <XAxis type="number" />
                  <Tooltip />
                  <Legend />
                  <Bar dataKey="totalMonthlyProduction" fill="#8884d8" />
                </BarChart>
              </ResponsiveContainer>
            ) : (
              <p className="text-center text-red-600">Recharts failed to load. Chart not displayed.</p>
            )}
          </div>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
