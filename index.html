<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dairy Management App</title>

  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.3/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/recharts@2.12.7/umd/Recharts.min.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; margin:0; padding:0; }
  </style>
</head>
<body class="bg-gray-100 p-4">
  <div id="root"></div>

  <script>
    const { useState } = React;
    const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = window.Recharts || {};

    const initialCows = [
      { name: 'MERCY', lastCalvingDate: '2024-07-14', lactationDays: 120, totalMonthlyProduction: 64.5 },
      { name: 'MAGRET', lastCalvingDate: '2024-07-17', lactationDays: 95, totalMonthlyProduction: 78.5 },
      { name: 'SARAH', lastCalvingDate: '2025-04-18', lactationDays: 60, totalMonthlyProduction: 62.5 }
    ];

    const App = () => {
      const today = new Date().toISOString().split('T')[0];
      const [cowData, setCowData] = useState(initialCows);
      const [selectedCow, setSelectedCow] = useState(initialCows[0].name);
      const [selectedDate, setSelectedDate] = useState(today);
      const [amProduction, setAmProduction] = useState('');
      const [pmProduction, setPmProduction] = useState('');
      const [newCowName, setNewCowName] = useState('');
      const [newLactationDays, setNewLactationDays] = useState('');

      const handleSaveProduction = () => {
        setCowData(prev => prev.map(cow => cow.name === selectedCow ? {
          ...cow,
          milk_data: {
            ...(cow.milk_data || {}),
            [selectedDate]: { am: parseFloat(amProduction)||0, pm: parseFloat(pmProduction)||0, total: parseFloat(amProduction||0)+parseFloat(pmProduction||0) }
          }
        } : cow));
      };

      const handleAddCow = () => {
        if (!newCowName || !newLactationDays) return;
        setCowData(prev => [...prev, { name: newCowName, lastCalvingDate: today, lactationDays: parseInt(newLactationDays), totalMonthlyProduction: 0, milk_data: {} }]);
        setNewCowName('');
        setNewLactationDays('');
      };

      const handleDeleteCow = (name) => {
        setCowData(prev => prev.filter(cow => cow.name !== name));
      };

      const totalDaily = parseFloat(amProduction||0) + parseFloat(pmProduction||0);

      return (
        React.createElement('div', { className: 'min-h-screen flex flex-col items-center p-4' },

          React.createElement('div', { className: 'w-full max-w-3xl bg-white p-6 rounded-2xl shadow-xl border mb-6' },
            React.createElement('h1', { className: 'text-3xl font-bold mb-4' }, 'Cow Milk Production'),

            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4 mb-4' },
              React.createElement('select', { value: selectedCow, onChange: e => setSelectedCow(e.target.value), className: 'p-2 border rounded-lg' },
                cowData.map(cow => React.createElement('option', { key: cow.name, value: cow.name }, cow.name))
              ),
              React.createElement('input', { type: 'date', value: selectedDate, onChange: e => setSelectedDate(e.target.value), className: 'p-2 border rounded-lg' }),
              React.createElement('button', { onClick: handleSaveProduction, className: 'bg-blue-600 text-white p-2 rounded-lg' }, 'Save Production')
            ),

            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4 mb-4' },
              React.createElement('input', { type: 'number', placeholder: 'AM Production', value: amProduction, onChange: e => setAmProduction(e.target.value), className: 'p-2 border rounded-lg' }),
              React.createElement('input', { type: 'number', placeholder: 'PM Production', value: pmProduction, onChange: e => setPmProduction(e.target.value), className: 'p-2 border rounded-lg' })
            ),
            React.createElement('p', null, `Total Daily: ${totalDaily}`)
          ),

          React.createElement('div', { className: 'w-full max-w-3xl bg-white p-6 rounded-2xl shadow-xl border mb-6' },
            React.createElement('h2', { className: 'text-2xl font-bold mb-4' }, 'Manage Cows'),
            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4 mb-4' },
              React.createElement('input', { type: 'text', placeholder: 'New Cow Name', value: newCowName, onChange: e => setNewCowName(e.target.value), className: 'p-2 border rounded-lg' }),
              React.createElement('input', { type: 'number', placeholder: 'Lactation Days', value: newLactationDays, onChange: e => setNewLactationDays(e.target.value), className: 'p-2 border rounded-lg' }),
              React.createElement('button', { onClick: handleAddCow, className: 'bg-green-600 text-white p-2 rounded-lg' }, 'Add Cow')
            ),

            React.createElement('table', { className: 'w-full text-left border-collapse' },
              React.createElement('thead', null,
                React.createElement('tr', null,
                  React.createElement('th', { className: 'border p-2' }, 'Name'),
                  React.createElement('th', { className: 'border p-2' }, 'Last Calving Date'),
                  React.createElement('th', { className: 'border p-2' }, 'Lactation Days'),
                  React.createElement('th', { className: 'border p-2' }, 'Total Monthly Production'),
                  React.createElement('th', { className: 'border p-2' }, 'Actions')
                )
              ),
              React.createElement('tbody', null,
                cowData.map(cow => React.createElement('tr', { key: cow.name },
                  React.createElement('td', { className: 'border p-2' }, cow.name),
                  React.createElement('td', { className: 'border p-2' }, cow.lastCalvingDate),
                  React.createElement('td', { className: 'border p-2' }, cow.lactationDays),
                  React.createElement('td', { className: 'border p-2' }, cow.totalMonthlyProduction),
                  React.createElement('td', { className: 'border p-2' },
                    React.createElement('button', { onClick: () => handleDeleteCow(cow.name), className: 'bg-red-600 text-white p-1 rounded' }, 'Delete')
                  )
                ))
              )
            )
          ),

          React.createElement('div', { className: 'w-full max-w-3xl bg-white p-6 rounded-2xl shadow-xl border' },
            React.createElement('h2', { className: 'text-2xl font-bold mb-4' }, 'Production Charts'),
            BarChart ? (
              React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                React.createElement(BarChart, { data: cowData, layout: 'vertical', margin: {top:20,right:30,left:20,bottom:5} },
                  React.createElement(CartesianGrid, { strokeDasharray: '3 3' }),
                  React.createElement(YAxis, { dataKey: 'name', type: 'category' }),
                  React.createElement(XAxis, { type: 'number' }),
                  React.createElement(Tooltip, null),
                  React.createElement(Legend, null),
                  React.createElement(Bar, { dataKey: 'totalMonthlyProduction', fill: '#8884d8' })
                )
              )
            ) : React.createElement('p', { className: 'text-center text-red-600' }, 'Recharts failed to load.')
          )
        )
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
  </script>
</body>
</html>
